<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transcription CSV Processor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="bootstrap5.min.css" rel="stylesheet">
  <script src="papaparse.min.js"></script>
  <script src="react.min.js"></script>
  <script src="react-dom.min.js"></script>
</head>
<body>
  <div class="container-fluid">
	  <div class="row mt-3">
		  <div class="col-6 mb-3">
			 <input class="form-control" type="file" id="fileInput">
		  </div>
	  </div>
	  
	  <div class="row mt-3" id="actions-div" style="visibility: hidden;">
		<div class="col-3">
			<button class="btn btn-secondary" onclick="copyCsv()">Copy CSV To Clipboard</button>
		</div>
		<div class="col-3">
			<a class="btn btn-secondary" id="downloadLink" download="processed.csv">Download Processed File</a>
		</div>
	  </div>
	  
	  <script src="script.js"></script>
	  
	  <div class="row mt-3">
		<div id="root"></div>
	  </div>
  </div>
  
  <script>
    // Generated by ChatGPT, don't judge
    function ParticipantTable(statistics) {
	  if (!statistics.hasOwnProperty("participants")) {
		return React.createElement('div', null);
	  }
	
	  const participantData = statistics.participants;
      const [selectedParticipant, setSelectedParticipant] = React.useState(Object.keys(participantData)[0]);

      const handleParticipantChange = (event) => {
        setSelectedParticipant(event.target.value);
      };

      const participantNames = Object.keys(participantData);

      return (
        React.createElement('div', null,
          React.createElement('label', { htmlFor: 'participants' }, 'Participant: '),
          React.createElement('select', { className: 'dropdown ms-2', id: 'participants', onChange: handleParticipantChange, value: selectedParticipant },
            participantNames.map((participant) =>
              React.createElement('option', { key: participant, value: participant }, participant)
            )
          ),

          React.createElement('h2', { className: 'mt-2' }, selectedParticipant),

          React.createElement('table', { className: 'table' },
            React.createElement('thead', null,
              React.createElement('tr', null,
                React.createElement('th', null, 'Word'),
                Object.keys(participantData[selectedParticipant].types).map((type) =>
                  React.createElement('th', { key: type }, type)
                )
              )
            ),
            React.createElement('tbody', null,
              (() => {
                const wordCountMap = {};

                Object.keys(participantData[selectedParticipant].types).forEach((type) => {
                  const words = participantData[selectedParticipant].types[type].words;
                  words.map(word => word.toUpperCase()).forEach((word) => {
                    if (!wordCountMap[word]) {
                      wordCountMap[word] = {};
                    }
                    wordCountMap[word][type] = wordCountMap[word][type] ? wordCountMap[word][type] + 1 : 1;
                  });
                });

                return Object.keys(wordCountMap).map((word, index) => (
                  React.createElement('tr', { key: index },
                    React.createElement('td', null, word),
                    Object.keys(participantData[selectedParticipant].types).map((type) => (
                      React.createElement('td', { key: type }, wordCountMap[word][type] || 0)
                    ))
                  )
                ));
              })()
            )
          )
        )
      );
    }

    function App() {
      const rootElement = document.getElementById('root');
	  
      ReactDOM.render(React.createElement(ParticipantTable, globalStatistics), rootElement);
    }
  </script>
</body>
</html>
